/**
@apparatus SovereignErrorRefineryDoctrine
@role Constituci√≥n de la Refiner√≠a Forense de Errores y Protocolos de Autocura.
@location .docs/manifiestos/002-sovereign-error-refinery-doctrine.md
@status <SUPREME_ZENITH>
@version 8.5.0 Zenith Edition
@protocol OEDP-V8.5 Lattice
*/
üõ°Ô∏è MANIFIESTO 002: DOCTRINA DE REFINER√çA DE ERRORES Y AUTOCURA NEURAL
Objetivo: Transmutar el fallo (Entrop√≠a No Estructurada) en inteligencia forense cifrada y activar protocolos de recuperaci√≥n at√≥mica. Bajo el protocolo Lattice, un error no es un evento terminal, es una se√±al sensorial que el Neural Sentinel utiliza para orquestar la resiliencia del Shell y garantizar la fluidez del ecosistema.
1. LA DOCTRINA DE LA TRANSMUTACI√ìN (NEUTRALIZACI√ìN DEL DOLOR)
En el ecosistema RazWrite Core, un error nativo es "Energ√≠a Negativa" ca√≥tica.
Neutralizaci√≥n Obligatoria: Ning√∫n error puede salir de la frontera de un b√∫nker (M-008) sin ser procesado por el SovereignErrorEngine. Queda prohibido el paso de excepciones crudas al Sovereign Nervous System (SNS).
Aduana de OpCodes: El c√≥digo de error humano (ej: RWC-SDUI-4001) debe ser transmutado a un Operation OpCode num√©rico mediante el Matrix Neural Bridge (MNB) para su procesamiento en el Plano del N√∫cleo (Deep-Pulse).
2. REGLAS DE ORO DE LA REFINER√çA LATTICE
TRY/CATCH EN FRONTERAS SOBERANAS: Obligatorio en todo Adaptador de Infraestructura y en el Nexo (.logic.ts) de cada b√∫nker.
DATA SCRUBBING AUTOM√ÅTICO: Antes de la captura del informationPayloadSnapshot, el motor debe anonimizar campos sensibles (tokens, claves, PII) bas√°ndose en el ADN (Schema) del b√∫nker afectado.
FACHADA DE CARGAMENTO √öNICO (M-010): El m√©todo transmute() es el √∫nico punto de ignici√≥n. Recibe un objeto validado por Zod que incluye el error original y el contexto metab√≥lico del sistema.
3. PROTOCOLO DE AUTOCURA (PREDICTIVE HEALING)
El motor de errores no solo informa, tambi√©n genera una Intenci√≥n de Recuperaci√≥n:
recoveryActionIntent: Un c√≥digo de comando que el SNS interpreta para:
Reiniciar el b√∫nker afectado (Soft Reset).
Purgar la rama espec√≠fica de la cach√© en el PersistenceBunker.
Redirigir al usuario a un "Estado Seguro" (Safe State) gestionado por el Atomic Lego Projector (ALP).
Sentinel Influence: Si el Neural Sentinel detecta una r√°faga de errores similares a trav√©s del Sentinel-Tether, puede inyectar un parche de l√≥gica ef√≠mero en el Deep-Pulse para mitigar el impacto.
4. ANATOM√çA DEL PAQUETE FORENSE (ERROR DNA V8.5)
El paquete forense circula como Materia Oscura (Cifrado):
code
TypeScript
interface IForensicErrorPacket {
  o: number;  // Operation OpCode (MatrixNeuralBridge)
  s: number;  // Severity OpCode (MatrixNeuralBridge)
  c: string;  // Correlation Identifier (SNS)
  u: string;  // Mutant Passport Identifier (IME)
  t: string;  // Tenant Identifier (SDUI Context)
  l: number;  // Metabolic State OpCode (Metabolic Scheduler)
  p: string;  // Cifrado (JWE): informationPayload + MemorySnapshot + RecoveryIntent
  st: string; // StackTrace comprimida, anonimizada y filtrada por el Linter
  msg: string; // Mensaje sem√°ntico (Alma)
}
5. OPTIMIZACI√ìN DE HILO (TRIPLE-THREAD REFINING)
La refiner√≠a opera para proteger la fluidez visual (60fps):
Capture (Surface-Pulse): El b√∫nker emite el fallo. El componente visual muestra una "Reacci√≥n de Gracia" (Fallback UI).
Offload (SNS): El Kernel desv√≠a el error crudo al Web Worker del ErrorEngine.
Refine (Deep-Pulse): El Worker cifra el payload, consulta el MNB y genera el rastro forense. Si el Metabolic-Scheduler reporta ECO, el refinado se compacta al m√≠nimo.
Broadcast: El paquete se publica en el SNS. El Neural Sentinel toma nota y el ALP ejecuta la recuperaci√≥n proyectada.
6. ESTRUCTURA L√ìGICA (PENTA-ESTRUCTURA M-008)
Ubicaci√≥n: libs/shared/error-engine/src/lib/error-refinery/
error-refinery.tsx: CUERPO - Boundary de React 19 para capturar fallos de superficie.
error-refinery.schema.ts: ADN - Contratos Zod para Errores, OpCodes e Intenciones de Recuperaci√≥n.
error-refinery.logic.ts: NEXO - Transmutaci√≥n, Scrubbing y orquestaci√≥n inicial.
error-refinery.worker.ts: CEREBRO - Web Worker para procesamiento pesado de stack-traces y cifrado JWE.
i18n/: ALMA - Mensajes sem√°nticos de recuperaci√≥n y fallo sist√©mico.
Firma de Autoridad:
Raz Podest√° - Arquitecto Jefe 